CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  firstname VARCHAR(255),
  lastname VARCHAR(255),
  birthdate DATE,
  gender VARCHAR(255),
  email VARCHAR(255) NOT NULL unique,
  password CHAR(60) NOT NULL,
  admin BOOLEAN DEFAULT false
);

CREATE UNIQUE INDEX ON users((lower(email)));

CREATE TABLE apartments (
  id SERIAL PRIMARY KEY,
  type VARCHAR(255) UNIQUE,
  quantity INTEGER,
  deposit FLOAT,
  price FLOAT
);

CREATE TABLE rooms (
  id SERIAL PRIMARY KEY,
  apartment_id INTEGER REFERENCES apartments(id),
  house INTEGER,
  city VARCHAR(255),
  zipcode VARCHAR(255),
  address VARCHAR(255) UNIQUE,
  sex VARCHAR(255) DEFAULT ''
  reserve VARCHAR(255) DEFAULT 'No'
);

CREATE TABLE application (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  apartment_id INTEGER REFERENCES apartments(id),
  date_request DATE DEFAULT current_date,
  date_rent DATE
);

CREATE TABLE rents (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) UNIQUE,
  room_id INTEGER REFERENCES rooms(id) UNIQUE,
  datestart DATE,
  duedate_deposit DATE,
  deposit_paid VARCHAR(255) DEFAULT 'No'
);

CREATE TABLE monthlypaid (
  id SERIAL PRIMARY KEY,
  rent_id INTEGER REFERENCES rents(id),
  month DATE,
  duedate_monthly DATE,
  monthly_paid VARCHAR(255) DEFAULT 'No'
);

CREATE TABLE maintenance (
  id SERIAL PRIMARY KEY,
  room_id INTEGER REFERENCES rooms(id),
  type VARCHAR(255) UNIQUE,
  date_report DATE,
  resolve VARCHAR(255) DEFAULT 'No'
);

----INSERT APARTMENTS-------
INSERT INTO apartments (type, quantity, deposit, price) VALUES ('2h-shared apartment',5, 250, 280.55);
INSERT INTO apartments (type, quantity, deposit, price) VALUES ('3h-shared apartment',5, 200, 250.24);
INSERT INTO apartments (type, quantity, deposit, price) VALUES ('1h-single apartment',4, 300, 350);
INSERT INTO apartments (type, quantity, deposit, price) VALUES ('2h-family apartment',3, 420, 460);

----INSERT ROOMS-----------
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 1, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 1/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 1, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 1/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 2, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 2/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 2, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 2/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 3, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 3/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 3, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 3/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 4, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 4/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 4, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 4/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 5, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 5/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (1, 5, 'Long Xuyen', 62000, 'Nguyen Thai Hoc 16 as 5/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 1, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 1/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 1, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 1/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 1, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 1/3');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 2, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 2/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 2, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 2/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 2, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 2/3');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 3, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 3/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 3, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 3/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 3, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 3/3');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 4, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 4/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 4, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 4/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 4, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 4/3');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 5, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 5/1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 5, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 5/2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (2, 5, 'Long Xuyen', 62000, 'Tran Hung Dao 5 as 5/3');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (3, 1, 'Long Xuyen', 62000, 'Quang Trung 2 as 1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (3, 2, 'Long Xuyen', 62000, 'Quang Trung 2 as 2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (3, 3, 'Long Xuyen', 62000, 'Quang Trung 2 as 3');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (3, 4, 'Long Xuyen', 62000, 'Quang Trung 2 as 4');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (4, 1, 'Long Xuyen', 62000, 'Yet Kieu 10 as 1');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (4, 2, 'Long Xuyen', 62000, 'Yet Kieu 10 as 2');
INSERT INTO rooms (apartment_id, house, city, zipcode, address) values (4, 3, 'Long Xuyen', 62000, 'Yet Kieu 10 as 3');

---INSERT ADMIN
INSERT INTO users (email, password, admin) VALUES ('admin@admin.com', '$2a$12$.lOV4EJhJqYWxVR/RSZtk.QapD6f90jC4JkU.L3O4Tokj5SqpjZcq', 'True')

---DROP ALL TABLES-----
drop table users cascade;
drop table apartments cascade;
drop table rooms cascade;
drop table application cascade;
drop table rents cascade;
drop table monthlypaid cascade;
drop table maintenance cascade;

		  
